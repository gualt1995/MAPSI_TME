<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0044)http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
	<title>MAPSI Cours/TME 3</title>
	<link href="./MAPSI Cours_TME 3_files/base.css" rel="stylesheet" type="text/css">
	<script type="text/javascript">g_DefaultStyle="fixed blue";</script>
	<script type="text/javascript" src="./MAPSI Cours_TME 3_files/app.js"></script>
<!--[if IE]>
<link href="http://mapsi.lip6.fr/pub/skins/skittlish/base_ie.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--HTMLHeader--><style type="text/css"><!--
.subpage h1, h1.subpage { margin:0px; margin-top:1.2em; margin-bottom:8px; 
    color: #006633;
	font-size: 150%; }
p.subpage { float: right; }
.editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }
#siteheader .sitetitle a{height:0px; background: url(http://example.com/mylogo.gif) left top no-repeat} #siteheader .sitetitle a, #siteheader .sitetag{padding-left: 0px} #siteheader .sitetag{margin-top: 44px}
  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for python
 * CSS class: , CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.python .de1, .python .de2 {font-family: monospace; font-weight: normal;}
.python  {font-family:monospace;}
.python .imp {font-weight: bold; color: red;}
.python li, .python .li1 {font-family: monospace; color: black; font-weight: normal;}
.python .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.python .li2 {font-weight: bold;}
.python .kw1 {color: #ff7700;font-weight:bold;}
.python .kw2 {color: #008000;}
.python .kw3 {color: #dc143c;}
.python .kw4 {color: #0000cd;}
.python .co1 {color: #808080; font-style: italic;}
.python .coMULTI {color: #808080; font-style: italic;}
.python .es0 {color: #000099; font-weight: bold;}
.python .br0 {color: black;}
.python .sy0 {color: #66cc66;}
.python .st0 {color: #483d8b;}
.python .nu0 {color: #ff4500;}
.python .me1 {color: black;}
.python .ln-xtra, .python li.ln-xtra, .python div.ln-xtra {background-color: #ffc;}
.python span.xtra { display:block; }

.sourceblocklink {
  text-align: right;
  font-size: smaller;
}
.sourceblocktext {
  padding: 0.5em;
  border: 1px solid #808080;
  color: #000000;
  background-color: #fafafa;
}
.sourceblocktext div {
  font-family: monospace;
  font-size: small;
  line-height: 1;
  height: 1%;
}
.sourceblocktext div.head,
.sourceblocktext div.foot {
  font: italic medium serif;
  padding: 0.5em;
}

--></style><script type="text/javascript" src="./MAPSI Cours_TME 3_files/MathJax.js">MathJax.Hub.Config({
    extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: { inlineMath: [ ['{\$','\$}'] ], displayMath: [ ['{\$\$','\$\$}'] ] } });</script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>  <meta name="robots" content="index,follow">

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style></head>

<body class="fixed blue"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<script type="text/javascript">
//<![CDATA[
	loadPreferences()
//]]>
</script>

	<div id="wrapper">
		<div id="header" class="clearfix">
			<div id="siteheader" class="clearfix">
				<!--PageHeaderFmt-->
				<h1 class="sitetitle"><a class="urllink" href="http://mapsi.lip6.fr/pmwiki.php" rel="nofollow">MAPSI</a></h1>
<div class="sitetag">Modèles et Algorithmes de Probabilités et Statistiques pour l'Informatique
</div>

				<!--/PageHeaderFmt-->
			</div>

			<!--PageTabsFmt-->
			<div id="menu">
				
			</div>
			<!--/PageTabsFmt-->
		</div>

		<div id="contentwrapper" class="clearfix">
			<div id="content">
				<div id="innerwrapper">
					<!--PageTitleGroupFmt-->
					<a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours" class="pagegroup">Cours</a>
					<!--/PageTitleGroupFmt-->
					<!--PageTitleFmt--><!--/PageTitleFmt-->

					<!--PageText-->
<div id="wikitext">
<div class="vspace"></div><h1>Apprentissage de paramètres par max de vraisemblance</h1>
<h2 style="background-color: #e6d8c0;">Partie obligatoire</h2>
<hr>
<p class="vspace">Dans ce TME, l'objectif est d'apprendre grâce à l'estimateur de maximum de vraisemblance les paramètres de lois normales à partir d'un ensemble de données. Ces lois normales seront ensuite exploitées pour faire de la classification (comme nous l'avions vu en cours avec les images de désert, forêt, mer et paysages enneigés).
</p>
<p class="vspace">Ici, notre base de données d'apprentissage est la base 
 <a target="_blank" class="urllink" href="https://www.otexts.org/1577" rel="nofollow">USPS</a>. Celle-ci contient les images réelles de chiffres provenant de codes postaux écrits manuellement et scannés par le service des postes américain. Ces données scannées ont été normalisées de manière à ce qu'elles soient toutes des images de 16x16 pixels en teintes de gris, cf. Le Cun et al., 1990:
</p>
<p class="vspace">Y. LeCun, O. Matan, B. Boser, J. S. Denker, <em>et al.</em> (1990) "Handwritten zip code recognition with multilayer networks". In ICPR, volume II, pages 35–40.
</p>
<p class="vspace">Voici quelques exemples d'images de cette base :
</p>
<div class="vspace"></div><div style="text-align: center;">   <img width="200px" src="./MAPSI Cours_TME 3_files/2015_tme3_digit4.jpg" alt="" title=""> <img width="200px" src="./MAPSI Cours_TME 3_files/2015_tme3_digit5.jpg" alt="" title=""> <img width="200px" src="./MAPSI Cours_TME 3_files/2015_tme3_digit8.jpg" alt="" title=""> </div>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">1. Préparation / visualisation</span></strong></span>
</p>
<p class="vspace">Vous allez tout d'abord copier-coller le code ci-dessous dans votre éditeur de python. Ne perdez pas de temps à essayer de comprendre les instructions de ces fonctions. Leur utilité est décrite en dessous du code.
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock1">
  <div class="sourceblocktext"><div class="python"><span class="co1"># -*- coding: utf-8 -*- </span><br>
<br>
<span class="kw1">import</span> numpy <span class="kw1">as</span> np<br>
<span class="kw1">import</span> matplotlib.<span class="me1">pyplot</span> <span class="kw1">as</span> plt<br>
<br>
<span class="kw1">def</span> read_file <span class="br0">(</span> filename <span class="br0">)</span>:<br>
&nbsp; &nbsp; <span class="st0">"""<br>
&nbsp; &nbsp; Lit un fichier USPS et renvoie un tableau de tableaux d'images.<br>
&nbsp; &nbsp; Chaque image est un tableau de nombres réels.<br>
&nbsp; &nbsp; Chaque tableau d'images contient des images de la même classe.<br>
&nbsp; &nbsp; Ainsi, T = read_file ( "fichier" ) est tel que T[0] est le tableau<br>
&nbsp; &nbsp; des images de la classe 0, T[1] contient celui des images de la classe 1,<br>
&nbsp; &nbsp; et ainsi de suite.<br>
&nbsp; &nbsp; """</span><br>
&nbsp; &nbsp; <span class="co1"># lecture de l'en-tête</span><br>
&nbsp; &nbsp; infile <span class="sy0">=</span> <span class="kw2">open</span> <span class="br0">(</span> filename<span class="sy0">,</span> <span class="st0">"r"</span> <span class="br0">)</span> &nbsp; &nbsp;<br>
&nbsp; &nbsp; nb_classes<span class="sy0">,</span> nb_features <span class="sy0">=</span> <span class="br0">[</span> <span class="kw2">int</span><span class="br0">(</span> x <span class="br0">)</span> <span class="kw1">for</span> x <span class="kw1">in</span> infile.<span class="kw3">readline</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">split</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">]</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># creation de la structure de données pour sauver les images :</span><br>
&nbsp; &nbsp; <span class="co1"># c'est un tableau de listes (1 par classe)</span><br>
&nbsp; &nbsp; data <span class="sy0">=</span> np.<span class="me1">empty</span> <span class="br0">(</span> <span class="nu0">10</span><span class="sy0">,</span> dtype<span class="sy0">=</span><span class="kw2">object</span> <span class="br0">)</span> &nbsp; <br>
&nbsp; &nbsp; filler <span class="sy0">=</span> np.<span class="me1">frompyfunc</span><span class="br0">(</span><span class="kw1">lambda</span> x: <span class="kw2">list</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">)</span><br>
&nbsp; &nbsp; filler<span class="br0">(</span> data<span class="sy0">,</span> data <span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># lecture des images du fichier et tri, classe par classe</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> ligne <span class="kw1">in</span> infile:<br>
&nbsp; &nbsp; &nbsp; &nbsp; champs <span class="sy0">=</span> ligne.<span class="me1">split</span> <span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="kw2">len</span> <span class="br0">(</span> champs <span class="br0">)</span> <span class="sy0">==</span> nb_features + <span class="nu0">1</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; classe <span class="sy0">=</span> <span class="kw2">int</span> <span class="br0">(</span> champs.<span class="me1">pop</span> <span class="br0">(</span> <span class="nu0">0</span> <span class="br0">)</span> <span class="br0">)</span><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data<span class="br0">[</span>classe<span class="br0">]</span>.<span class="me1">append</span> <span class="br0">(</span> <span class="kw2">list</span> <span class="br0">(</span> <span class="kw2">map</span> <span class="br0">(</span> <span class="kw1">lambda</span> x: <span class="kw2">float</span><span class="br0">(</span>x<span class="br0">)</span><span class="sy0">,</span> champs <span class="br0">)</span> <span class="br0">)</span> <span class="br0">)</span><br>
&nbsp; &nbsp; infile.<span class="me1">close</span> <span class="br0">(</span><span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># transformation des list en array</span><br>
&nbsp; &nbsp; output &nbsp;<span class="sy0">=</span> np.<span class="me1">empty</span> <span class="br0">(</span> <span class="nu0">10</span><span class="sy0">,</span> dtype<span class="sy0">=</span><span class="kw2">object</span> <span class="br0">)</span><br>
&nbsp; &nbsp; filler2 <span class="sy0">=</span> np.<span class="me1">frompyfunc</span><span class="br0">(</span><span class="kw1">lambda</span> x: np.<span class="me1">asarray</span> <span class="br0">(</span>x<span class="br0">)</span><span class="sy0">,</span> <span class="nu0">1</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">)</span><br>
&nbsp; &nbsp; filler2 <span class="br0">(</span> data<span class="sy0">,</span> output <span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="kw1">return</span> output<br>
<br>
<span class="kw1">def</span> display_image <span class="br0">(</span> X <span class="br0">)</span>:<br>
&nbsp; &nbsp; <span class="st0">"""<br>
&nbsp; &nbsp; Etant donné un tableau X de 256 flotants représentant une image de 16x16<br>
&nbsp; &nbsp; pixels, la fonction affiche cette image dans une fenêtre.<br>
&nbsp; &nbsp; """</span><br>
&nbsp; &nbsp; <span class="co1"># on teste que le tableau contient bien 256 valeurs</span><br>
&nbsp; &nbsp; <span class="kw1">if</span> X.<span class="me1">size</span> <span class="sy0">!=</span> <span class="nu0">256</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">raise</span> <span class="kw2">ValueError</span> <span class="br0">(</span> <span class="st0">"Les images doivent être de 16x16 pixels"</span> <span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># on crée une image pour imshow: chaque pixel est un tableau à 3 valeurs</span><br>
&nbsp; &nbsp; <span class="co1"># (1 pour chaque canal R,G,B). Ces valeurs sont entre 0 et 1</span><br>
&nbsp; &nbsp; Y <span class="sy0">=</span> X / X.<span class="kw2">max</span> <span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; img <span class="sy0">=</span> np.<span class="me1">zeros</span> <span class="br0">(</span> <span class="br0">(</span> Y.<span class="me1">size</span><span class="sy0">,</span> <span class="nu0">3</span> <span class="br0">)</span> <span class="br0">)</span><br>
&nbsp; &nbsp; <span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">range</span> <span class="br0">(</span> <span class="nu0">3</span> <span class="br0">)</span>:<br>
&nbsp; &nbsp; &nbsp; &nbsp; img<span class="br0">[</span>:<span class="sy0">,</span>i<span class="br0">]</span> <span class="sy0">=</span> X<br>
<br>
&nbsp; &nbsp; <span class="co1"># on indique que toutes les images sont de 16x16 pixels</span><br>
&nbsp; &nbsp; img.<span class="me1">shape</span> <span class="sy0">=</span> <span class="br0">(</span><span class="nu0">16</span><span class="sy0">,</span><span class="nu0">16</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">)</span><br>
<br>
&nbsp; &nbsp; <span class="co1"># affichage de l'image</span><br>
&nbsp; &nbsp; plt.<span class="me1">imshow</span><span class="br0">(</span> img <span class="br0">)</span><br>
&nbsp; &nbsp; plt.<span class="me1">show</span> <span class="br0">(</span><span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=1" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace">La base qui va vous servir pour votre apprentissage de paramètres s'appelle <a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/2015_tme3_usps_train.txt" rel="nofollow">2015_tme3_usps_train.txt</a>. Téléchargez-la. La fonction <strong>read_file</strong> <code>: string -&gt; float np.array n.array np.array</code> contenue dans le code python ci-dessus permet de lire ce fichier.
Cette fonction renvoie un tableau de tableaux d'images:
</p>
<div class="vspace"></div><ul><li>Chaque image a une taille de 16x16 pixels et représente un chiffre entre 0 et 9. Par exemple :
</li></ul><div class="vspace"></div><div style="text-align: center;">   <img width="200px" src="./MAPSI Cours_TME 3_files/2015_tme3_digit4.jpg" alt="" title=""> <img width="200px" src="./MAPSI Cours_TME 3_files/2015_tme3_digit5.jpg" alt="" title=""> <img width="200px" src="./MAPSI Cours_TME 3_files/2015_tme3_digit8.jpg" alt="" title=""> </div>
<div class="vspace"></div><ul><li>Chaque image est modélisée par un tableau numpy de 256 nombres réels compris entre 0 et 2, qui caractérisent l'intensité des pixels dans l'image (16x16 = 256 pixels).
<div class="vspace"></div></li><li>Les images correspondant au même chiffre manuscript (0,...,9) sont placées dans un même tableau. Le fichier usps indique en effet pour chaque image à quel chiffre celle-ci correspond. Dans le jargon de l'apprentissage, les chiffres sont appelés <strong>classes</strong> et, lorsque nous aurons de nouvelles images dont nous essayerons de déterminer, grâce à nos lois normales, à quel chiffre elles correspondent, nous dirons que nous faisons de la <strong>classification</strong>. Enfin, apprendre les paramètres de nos lois normales à partir d'un fichier qui contient pour chaque image sa classe s'appelle de l<strong>'apprentissage supervisé</strong>. 
<div class="vspace"></div></li><li>Pour terminer la description de l'objet retourné par la fonction <strong>read_file</strong>, les tableaux d'images correspondant à chaque chiffre sont eux-mêmes stockés dans un tableau et c'est ce dernier qui est renvoyé. Chaque élément de ce tableau correspond donc à l'ensemble des images d'une classe. Le premier élément contient ainsi toutes les images du chiffre 0, le 2ème toutes celles du chiffre 1, et ainsi de suite. Par exemple, si <strong>read_file</strong>("fichier") retourne un objet <code>training_data</code>, alors <code>training_data[2]</code> est le tableau de toutes les images du chiffre 2, et <code>training_data[2][3]</code> correspond à la 4ème image du chiffre 2 (les indices des tableaux débutant à 0), autrement dit à un tableau de 256 nombres réels représentant cette image.
</li></ul><p class="vspace"><br>
La fonction <strong>display_image</strong>, quant à elle, permet de visualiser les images que vous allez manipuler. Celle-ci prend donc en argument une image (c'est-à-dire un tableau de 256 nombres réels) et l'affiche dans une fenêtre. Exécutez cette fonction sur quelques images de votre base d'apprentissage afin de visualiser les données que vous allez manipuler par la suite. Par exemple, vous pouvez tester:
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock2">
  <div class="sourceblocktext"><div class="python">training_data <span class="sy0">=</span> read_file <span class="br0">(</span> <span class="st0">"2015_tme3_usps_train.txt"</span> <span class="br0">)</span><br>
<br>
<span class="co1"># affichage du 1er chiffre "2" de la base:</span><br>
display_image <span class="br0">(</span> training_data<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="br0">)</span><br>
<br>
<span class="co1"># affichage du 5ème chiffre "3" de la base:</span><br>
display_image <span class="br0">(</span> training_data<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span> <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=2" type="text/plain">[$[Get Code]]</a></div>
</div>

<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">2. Maximum de vraisemblance pour une classe</span></strong></span>
</p>
<p class="vspace">Dans ce TME, nous allons étudier la distribution de probabilité des teintes de gris des images (en fait, nous allons étudier sa fonction de densité car on travaille sur des variables aléatoires continues) . Nous allons faire l'hypothèse (certes un peu forte mais tellement pratique) que, dans chaque classe, les <strong>teintes des pixels sont mutuellement indépendantes</strong>. Autrement dit, si <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 1.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.125em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.312em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 1.125em; height: 0px;"><span style="position: absolute; clip: rect(1.312em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.813em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.144em; vertical-align: -0.3em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">X_i</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-6" style="width: 1.686em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.374em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.374em 1000em 2.434em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.252em;">=</span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">i=</script>0,...,255, représente la variable aléatoire "intensité de gris du <em>i</em>ème pixel", alors <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-10" style="width: 8.231em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.735em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.312em 1000em 2.683em -0.62em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 1.25em; height: 0px;"><span style="position: absolute; clip: rect(1.312em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.813em;"><span class="mn" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-20" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.935em; height: 0px;"><span style="position: absolute; clip: rect(1.312em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.813em;"><span class="texatom" id="MathJax-Span-22"><span class="mrow" id="MathJax-Span-23"><span class="mn" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.373em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">p(X_0,\ldots,X_{255})</script> représente la fonction de densité des teintes de gris des images de la classe et:
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" style=""><nobr><span class="math" id="MathJax-Span-26" style="width: 14.714em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.033em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(0.315em 1000em 3.618em -0.62em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-30"><span style="display: inline-block; position: relative; width: 1.25em; height: 0px;"><span style="position: absolute; clip: rect(1.312em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.813em;"><span class="mn" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-36" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.935em; height: 0px;"><span style="position: absolute; clip: rect(1.312em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.813em;"><span class="texatom" id="MathJax-Span-38"><span class="mrow" id="MathJax-Span-39"><span class="mn" id="MathJax-Span-40" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main; padding-left: 0.252em;">=</span><span class="munderover" id="MathJax-Span-43" style="padding-left: 0.252em;"><span style="display: inline-block; position: relative; width: 1.25em; height: 0px;"><span style="position: absolute; clip: rect(2.122em 1000em 3.868em -0.496em); top: -3.238em; left: 0.003em;"><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Size2; vertical-align: 0.003em;">&#8719;</span><span style="display: inline-block; width: 0px; height: 3.244em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.496em -0.558em); top: -1.119em; left: 0.065em;"><span class="texatom" id="MathJax-Span-45"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.437em 1000em 2.372em -0.496em); top: -3.301em; left: 0.128em;"><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mn" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.19em;">p</span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-55"><span style="display: inline-block; position: relative; width: 1.125em; height: 0px;"><span style="position: absolute; clip: rect(1.312em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.813em;"><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-58" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main;">.</span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.73em; vertical-align: -1.517em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">p(X_0,\ldots,X_{255}) = \prod_{i=0}^{255} p(X_i).</script>
</p>
<p class="vspace">Ainsi, en choisissant au hasard une image dans l'ensemble de toutes les images possibles de la classe, si celle-ci correspond au tableau <code>np.array([x_0,...,x_255])</code>, où les <code>x_i</code> sont des nombres réels compris entre 0 et 2, alors la valeur de la fonction de densité de l'image est égale à <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-60" style="width: 0.626em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.502em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.62em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-61"><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.916em; vertical-align: -0.3em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">p</script>(<code>x_0,...,x_255</code>) = <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-63" style="width: 3.431em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.808em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.063em 1000em 2.683em -0.496em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-64"><span class="munderover" id="MathJax-Span-65"><span style="display: inline-block; position: relative; width: 2.122em; height: 0px;"><span style="position: absolute; clip: rect(1.374em 1000em 2.746em -0.496em); top: -2.303em; left: 0.003em;"><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Size1; vertical-align: 0.003em;">&#8719;</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.677em; left: 0.938em;"><span class="texatom" id="MathJax-Span-67"><span class="mrow" id="MathJax-Span-68"><span class="mn" id="MathJax-Span-69" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.558em); top: -1.867em; left: 0.938em;"><span class="texatom" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="mi" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-73" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-74" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.19em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.677em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">\prod_{i=0}^{255} p</script>(<code>x_i</code>).
</p>
<p class="vspace">Nous allons de plus supposer que chaque <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-76" style="width: 1.374em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.125em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.312em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-77"><span class="msubsup" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 1.125em; height: 0px;"><span style="position: absolute; clip: rect(1.312em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.813em;"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.144em; vertical-align: -0.3em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">X_i</script> suit une distribution normale de paramètres <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-81" style="width: 3.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.244em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.25em 1000em 2.746em -0.433em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-82"><span class="mo" id="MathJax-Span-83" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-84"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mi" id="MathJax-Span-86" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-87" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-88" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-90" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.525em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">(\mu_i,\sigma^2_i)</script> (autrement dit, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-93" style="width: 0.626em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.502em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.62em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-94"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.916em; vertical-align: -0.3em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">p</script>(<code>X_i</code>) = <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-96" style="width: 5.177em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.242em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.25em 1000em 2.746em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-97"><span class="texatom" id="MathJax-Span-98"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Caligraphic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.19em;"></span></span></span></span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-102"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-106" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.686em 1000em 2.372em -0.558em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-108" style="font-size: 70.7%; font-family: MathJax_Caligraphic;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mi" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.525em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">\cal{N}(\mu_i,\sigma^2_i)</script>). Par maximum de vraisemblance, estimez, pour une classe donnée, l'ensemble des paramètres <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-111" style="width: 7.171em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.862em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.312em 1000em 2.683em -0.433em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-112"><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mn" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-120" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.748em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="texatom" id="MathJax-Span-122"><span class="mrow" id="MathJax-Span-123"><span class="mn" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.373em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">(\mu_0,\ldots,\mu_{255})</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-126" style="width: 7.047em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.738em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.25em 1000em 2.746em -0.433em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-127"><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mn" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-136" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.686em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -1.867em; left: 0.564em;"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mn" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-142" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.525em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">(\sigma_0^2,\ldots,\sigma_{255}^2)</script>. Pour cela, écrivez une fonction <strong>learnML_class_parameters</strong> <code>: float np.array np.array -&gt; float np.array x float np.array</code> qui, étant donné le tableau d'images d'une classe tel que retourné par la fonction <strong>read_file</strong> (autrement dit un tableau de tableaux de 256 nombres réels), renvoie un couple de tableaux, le premier élément du couple correspondant à l'ensemble des <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-143" style="width: 1.187em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.561em 1000em 2.621em -0.558em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-144"><span class="msubsup" id="MathJax-Span-145"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">\mu_i</script> et le 2ème à l'ensemble des <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-148" style="width: 1.312em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.187em 1000em 2.683em -0.558em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-149"><span class="msubsup" id="MathJax-Span-150"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-152" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mi" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.525em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\sigma_i^2</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-154" style="width: 1.686em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.374em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.374em 1000em 2.434em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-155"><span class="mi" id="MathJax-Span-156" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.252em;">=</span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">i=</script>0,...,255. C'est-à-dire que <strong>learnML_class_parameters</strong> ( classe ) renverra un objet similaire à :
</p>
<p class="vspace" style="text-align: center;"> ( array ( [<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-158" style="width: 6.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.624em 1000em 2.683em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-159"><span class="msubsup" id="MathJax-Span-160"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mn" id="MathJax-Span-162" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-166" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.748em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="texatom" id="MathJax-Span-168"><span class="mrow" id="MathJax-Span-169"><span class="mn" id="MathJax-Span-170" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">\mu_0,\ldots,\mu_{255}</script>] ), array ( [<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-171" style="width: 6.112em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.99em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.25em 1000em 2.746em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-172"><span class="msubsup" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-174" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-175" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mn" id="MathJax-Span-176" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-177" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-180" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.686em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -1.867em; left: 0.564em;"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mn" id="MathJax-Span-185" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.525em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">\sigma_0^2,\ldots,\sigma_{255}^2</script>] ) )
</p>
<p class="vspace">Grâce à votre fonction <strong>learnML_class_parameters</strong>, vous pouvez verifier que:
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock3">
  <div class="sourceblocktext"><div class="python">learnML_class_parameters <span class="br0">(</span> training_data<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=3" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><pre> (array([ 1.37185930e-03,   4.60217755e-03,   1.50770519e-02,
          5.87487437e-02,   1.66657454e-01,   4.28577052e-01,
          8.68415410e-01,   1.15260804e+00,   1.04628392e+00,
          6.46298995e-01,   2.58751256e-01,   7.90837521e-02,
          ...............................
          1.28302848e+00,   1.52802513e+00,   1.43905193e+00,
          1.04248827e+00,   5.32985762e-01,   1.74494137e-01,
          3.24891122e-02,   3.47487437e-03,   6.36515913e-05,
          0.00000000e+00]), 
  array([ 2.24522353e-03,   6.60664324e-03,   1.95906222e-02,
          6.29011999e-02,   1.80366523e-01,   3.72113773e-01,
          5.31683397e-01,   5.38201451e-01,   5.62586277e-01,
          4.57620803e-01,   2.35928060e-01,   8.26775407e-02,
          ...............................
          4.46902042e-01,   3.40271867e-01,   1.30177809e-01,
          2.49171310e-02,   1.77752743e-03,   4.23882955e-06,
          0.00000000e+00] ) )
</pre><div class="vspace"></div>
<div class="sourceblock " id="sourceblock4">
  <div class="sourceblocktext"><div class="python">learnML_class_parameters <span class="br0">(</span> training_data<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span> <span class="br0">)</span><br>
&nbsp;</div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=4" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><pre> (array([ 0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   3.98009950e-06,   1.27223881e-02,
          3.64843781e-01,   1.47724776e+00,   9.99703483e-01,
          1.18331343e-01,   4.97313433e-03,   0.00000000e+00,
          ...............................
          4.32477612e-01,   3.99064677e-02,   3.73731343e-03,
          6.62686567e-04,   4.67661692e-04,   0.00000000e+00,
          0.00000000e+00]), 
  array([ 0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   1.59045568e-08,   7.47939656e-03,
          2.52206480e-01,   2.13186449e-01,   3.40351753e-01,
          7.76266554e-02,   3.64318435e-03,   0.00000000e+00,
          ...............................
          3.20651061e-01,   4.13332529e-02,   4.10675488e-03,
          4.40910100e-04,   2.19582288e-04,   0.00000000e+00,
          0.00000000e+00] ) )
</pre><p class="vspace"><br>
<span style="font-size:120%"><strong><span style="color: blue;">3. Maximum de vraisemblance pour toutes les classes</span></strong></span>
</p>
<p class="vspace">En utilisant la fonction de la question précédente, écrivez une fonction <strong>learnML_all_parameters</strong> <code>: float np.array np.array np.array -&gt; (float np.array x float np.array) list</code> qui, étant donné le tableau <code>training_data</code> retourné par la fonction <strong>read_file</strong> (donc contenant toutes les images de toutes les classes), renvoie une <strong>liste</strong> de couples ( array ( [<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-186" style="width: 6.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.624em 1000em 2.683em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-187"><span class="msubsup" id="MathJax-Span-188"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mn" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-192" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-193" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-194" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.748em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="texatom" id="MathJax-Span-196"><span class="mrow" id="MathJax-Span-197"><span class="mn" id="MathJax-Span-198" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">\mu_0,\ldots,\mu_{255}</script>] ), array ( [<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-199" style="width: 6.112em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.99em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.25em 1000em 2.746em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-200"><span class="msubsup" id="MathJax-Span-201"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-202" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mn" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-205" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-206" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-207" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-208" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.686em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -1.867em; left: 0.564em;"><span class="texatom" id="MathJax-Span-211"><span class="mrow" id="MathJax-Span-212"><span class="mn" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.525em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">\sigma_0^2,\ldots,\sigma_{255}^2</script>] ) ). Vous exécuterez cette fonction sur vos données d'apprentissage et sauvegarderez le résultat dans une variable <strong>parameters</strong>.<br><br>
</p>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">4. Log-vraisemblance d'une image</span></strong></span>
</p>
<p class="vspace">Nous allons maintenant tester si, étant donné de nouvelles images, on peut classer celles-ci correctement, c'est-à-dire si on peut retrouver les chiffres auxquelles elles correspondent. Pour cela, nous allons utiliser de nouvelles images se trouvant dans le fichier 
<a class="urllink" href="http://mapsi.lip6.fr/uploads/Cours/2015_tme3_usps_test.txt" rel="nofollow">2015_tme3_usps_test.txt</a>. Ce fichier a exactement le même format que celui d'apprentissage et peut donc être lu grâce à la fonction <strong>read_file</strong>. En particulier, pour chaque image, nous avons le chiffre auquel elle correspond, ce qui nous permettra de vérifier que notre classifieur fonctionne correctement. Téléchargez le fichier et lisez-le en utilisant <strong>read_file</strong>.
</p>
<p class="vspace">Ecrivez une fonction <strong>log_likelihood</strong> <code>: float np.array x (float np.array,np.array) -&gt; float</code> qui, étant donné une image (donc un tableau de 256 nombres réels) et un couple
( array ( [<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-214" style="width: 6.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.052em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.624em 1000em 2.683em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-215"><span class="msubsup" id="MathJax-Span-216"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mn" id="MathJax-Span-218" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-221" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-222" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.748em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="texatom" id="MathJax-Span-224"><span class="mrow" id="MathJax-Span-225"><span class="mn" id="MathJax-Span-226" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">\mu_0,\ldots,\mu_{255}</script>] ), array ( [<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-227" style="width: 6.112em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.99em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.25em 1000em 2.746em -0.558em); top: -2.241em; left: 0.003em;"><span class="mrow" id="MathJax-Span-228"><span class="msubsup" id="MathJax-Span-229"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-231" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mn" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-233" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-236" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.686em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -1.867em; left: 0.564em;"><span class="texatom" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mn" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.525em; vertical-align: -0.452em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">\sigma_0^2,\ldots,\sigma_{255}^2</script>] ) ),
renvoie la log-vraisemblance qu'aurait l'image selon cet ensemble de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-242" style="width: 1.187em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.561em 1000em 2.621em -0.558em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-243"><span class="msubsup" id="MathJax-Span-244"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mi" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.992em; vertical-align: -0.376em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\mu_i</script> et <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-247" style="width: 1.063em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.876em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-248"><span class="msubsup" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 0.876em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.564em;"><span class="mi" id="MathJax-Span-251" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.84em; vertical-align: -0.3em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\sigma_i</script>. Rappelez-vous que:
</p>
<p class="vspace"><span class="MathJax_Preview"></span><div class="MathJax_Display" role="textbox" aria-readonly="true" style="text-align: center;"><span class="MathJax" id="MathJax-Element-24-Frame" style=""><nobr><span class="math" id="MathJax-Span-252" style="width: 38.026em; display: inline-block;"><span style="display: inline-block; position: relative; width: 31.169em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(2.06em 1000em 5.426em -0.558em); top: -3.986em; left: 0.003em;"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-255"></span><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.19em;">p</span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.496em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.564em;"><span class="mn" id="MathJax-Span-260" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main; padding-left: 0.19em;">…</span><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main; padding-left: 0.19em;">,</span><span class="msubsup" id="MathJax-Span-264" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 1.686em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.496em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.564em;"><span class="texatom" id="MathJax-Span-266"><span class="mrow" id="MathJax-Span-267"><span class="mn" id="MathJax-Span-268" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.252em;">=</span><span class="munderover" id="MathJax-Span-271" style="padding-left: 0.252em;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(2.122em 1000em 3.868em -0.496em); top: -3.238em; left: 0.003em;"><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Size2; vertical-align: 0.003em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.244em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.496em -0.558em); top: -1.119em; left: 0.19em;"><span class="texatom" id="MathJax-Span-273"><span class="mrow" id="MathJax-Span-274"><span class="mi" id="MathJax-Span-275" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-276" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.437em 1000em 2.372em -0.496em); top: -3.301em; left: 0.19em;"><span class="texatom" id="MathJax-Span-278"><span class="mrow" id="MathJax-Span-279"><span class="mn" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Main; padding-left: 0.19em;">log</span><span class="mo" id="MathJax-Span-282"></span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.19em;">p</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-285"><span style="display: inline-block; position: relative; width: 0.876em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.496em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.564em;"><span class="mi" id="MathJax-Span-287" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-288" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main; padding-left: 0.252em;">=</span><span class="munderover" id="MathJax-Span-290" style="padding-left: 0.252em;"><span style="display: inline-block; position: relative; width: 1.437em; height: 0px;"><span style="position: absolute; clip: rect(2.122em 1000em 3.868em -0.496em); top: -3.238em; left: 0.003em;"><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Size2; vertical-align: 0.003em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 3.244em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.496em -0.558em); top: -1.119em; left: 0.19em;"><span class="texatom" id="MathJax-Span-292"><span class="mrow" id="MathJax-Span-293"><span class="mi" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.437em 1000em 2.372em -0.496em); top: -3.301em; left: 0.19em;"><span class="texatom" id="MathJax-Span-297"><span class="mrow" id="MathJax-Span-298"><span class="mn" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">255</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mrow" id="MathJax-Span-300" style="padding-left: 0.19em;"><span class="mo" id="MathJax-Span-301" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size4;">[</span></span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">&#8722;</span><span class="mfrac" id="MathJax-Span-303" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 0.626em; height: 0px; margin-right: 0.128em; margin-left: 0.128em;"><span style="position: absolute; clip: rect(1.374em 1000em 2.434em -0.496em); top: -2.927em; left: 50%; margin-left: -0.246em;"><span class="mn" id="MathJax-Span-304" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span><span style="position: absolute; clip: rect(1.374em 1000em 2.434em -0.496em); top: -1.555em; left: 50%; margin-left: -0.246em;"><span class="mn" id="MathJax-Span-305" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span><span style="position: absolute; clip: rect(0.813em 1000em 1.25em -0.558em); top: -1.306em; left: 0.003em;"><span style="border-left: 0.626em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.063em;"></span></span></span></span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Main; padding-left: 0.19em;">log</span><span class="mo" id="MathJax-Span-307"></span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-309" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math; font-style: italic;">&#960;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mi" id="MathJax-Span-314" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main; padding-left: 0.252em;">&#8722;</span><span class="mfrac" id="MathJax-Span-317" style="padding-left: 0.252em;"><span style="display: inline-block; position: relative; width: 0.626em; height: 0px; margin-right: 0.128em; margin-left: 0.128em;"><span style="position: absolute; clip: rect(1.374em 1000em 2.434em -0.496em); top: -2.927em; left: 50%; margin-left: -0.246em;"><span class="mn" id="MathJax-Span-318" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span><span style="position: absolute; clip: rect(1.374em 1000em 2.434em -0.496em); top: -1.555em; left: 50%; margin-left: -0.246em;"><span class="mn" id="MathJax-Span-319" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span><span style="position: absolute; clip: rect(0.813em 1000em 1.25em -0.558em); top: -1.306em; left: 0.003em;"><span style="border-left: 0.626em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.063em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-320" style="padding-left: 0.19em;"><span style="display: inline-block; position: relative; width: 4.366em; height: 0px; margin-right: 0.128em; margin-left: 0.128em;"><span style="position: absolute; clip: rect(1.125em 1000em 2.683em -0.433em); top: -2.989em; left: 50%; margin-left: -2.116em;"><span class="mrow" id="MathJax-Span-321"><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 0.876em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.496em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.054em; left: 0.564em;"><span class="mi" id="MathJax-Span-325" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main; padding-left: 0.252em;">&#8722;</span><span class="msubsup" id="MathJax-Span-327" style="padding-left: 0.252em;"><span style="display: inline-block; position: relative; width: 0.938em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math; font-style: italic;">&#956;</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -1.929em; left: 0.626em;"><span class="mi" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-330"><span style="display: inline-block; position: relative; width: 0.813em; height: 0px;"><span style="position: absolute; clip: rect(1.312em 1000em 2.683em -0.496em); top: -2.241em; left: 0.003em;"><span class="mo" id="MathJax-Span-331" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span><span style="position: absolute; top: -2.677em; left: 0.377em;"><span class="mn" id="MathJax-Span-332" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.247em;"></span></span><span style="position: absolute; clip: rect(2.995em 1000em 4.491em -0.558em); top: -3.176em; left: 50%; margin-left: -0.558em;"><span class="msubsup" id="MathJax-Span-333"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.496em); top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-335" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -1.867em; left: 0.564em;"><span class="mi" id="MathJax-Span-336" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.813em 1000em 1.25em -0.558em); top: -1.306em; left: 0.003em;"><span style="border-left: 4.366em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.25px; vertical-align: 0.003em;"></span><span style="display: inline-block; width: 0px; height: 1.063em;"></span></span></span></span><span class="mo" id="MathJax-Span-337" style="vertical-align: 0.003em;"><span style="font-family: MathJax_Size4;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 3.806em; vertical-align: -1.593em;"></span></span></nobr></span></div><script type="math/tex; mode=display" id="MathJax-Element-24">\log p(x_0,\ldots,x_{255}) = \sum_{i=0}^{255} \log p(x_i) = \sum_{i=0}^{255} \left[- \frac{1}{2} \log(2 \pi \sigma_i^2) - \frac{1}{2} \frac{(x_i - \mu_i)^2}{\sigma_i^2}\right]</script>
</p>
<p class="vspace">Notez que le module <strong>math</strong> contient une constante <code>math.pi</code>. 
<strong>Attention:</strong> dans la liste <code>parameters</code> calculée dans la question précédente, pour certains pixels de certaines classes, la valeur de <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-338" style="width: 1.312em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.187em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-339"><span class="msubsup" id="MathJax-Span-340"><span style="display: inline-block; position: relative; width: 1.063em; height: 0px;"><span style="position: absolute; clip: rect(1.561em 1000em 2.372em -0.558em); top: -2.179em; left: 0.003em;"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math; font-style: italic;">&#963;<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; top: -2.553em; left: 0.626em;"><span class="mn" id="MathJax-Span-342" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.221em; vertical-align: -0.072em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\sigma^2</script> est égale à 0 (toutes les images de la base d'apprentissage avaient exactement la même valeur sur ce pixel). Dans ce cas, la vraisemblance de toute image sur ce pixel doit être de 1 (et donc sa log-vraisemblance doit être égale à 0).
</p>
<p class="vspace">Vous pourrez vérifier que vous obtenez les mêmes résultats que ci-dessous:
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock5">
  <div class="sourceblocktext"><div class="python">parameters <span class="sy0">=</span> learnML_all_parameters <span class="br0">(</span> training_data <span class="br0">)</span><br>
test_data <span class="sy0">=</span> read_file <span class="br0">(</span> <span class="st0">"2015_tme3_usps_test.txt"</span> <span class="br0">)</span><br>
log_likelihood <span class="br0">(</span> test_data<span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="sy0">,</span> parameters<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span> <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=5" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><pre> -36631213.400524415
</pre><div class="vspace"></div>
<div class="sourceblock " id="sourceblock6">
  <div class="sourceblocktext"><div class="python"><span class="br0">[</span> log_likelihood <span class="br0">(</span> test_data<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="sy0">,</span> parameters<span class="br0">[</span>i<span class="br0">]</span> <span class="br0">)</span> <span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">range</span> <span class="br0">(</span> <span class="nu0">10</span> <span class="br0">)</span> <span class="br0">]</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=6" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><pre> [-80.594309481001218, -2030714328.0707991, -339.70961551873495, -373.97785273732529,
  -678.16479308314922, -364.62227994586954, -715.4508284953547,  -344286.66839952325,
  -499.88159107145611, -35419.208662902507]
</pre><p class="vspace"><br>
<span style="font-size:120%"><strong><span style="color: blue;">5. Log-vraisemblance d'une image (bis)</span></strong></span>
</p>
<p class="vspace">Ecrivez une fonction <strong>log_likelihoods</strong> <code>: float np.array x (float np.array,np.array) list -&gt; float np.array</code> qui, étant donné une image (donc un tableau de 256 nombres réels) et la liste de paramètres déterminés dans la question 3, renvoie un tableau contenant, pour chaque chiffre possible entre 0 et 9, la log-vraisemblance qu'aurait l'image si celle-ci correspondait à ce chiffre. Ainsi, si tab = <strong>log_likelihoods</strong> ( image, parameters ), tab est un tableau de 10 éléments (les 10 chiffres possibles) et tab[3] est égal à la log-vraisemblance de l'image dans la classe "chiffre = 3".
</p>
<p class="vspace">Vous pourrez vérifier que vous obtenez les mêmes résultats que ci-dessous:
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock7">
  <div class="sourceblocktext"><div class="python">log_likelihoods <span class="br0">(</span> test_data<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span><span class="sy0">,</span> parameters <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=7" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><pre> array([-889.22508387,  184.03163176, -185.29589129, -265.13424326,
        -149.54804688, -215.85994204,  -94.86965712, -255.60771575,
        -118.95170104,  -71.5970028 ])
</pre><p class="vspace"><br>
</p>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">6. Classification d'une image</span></strong></span>
</p>
<p class="vspace">Ecrivez une fonction <strong>classify_image</strong> <code>: float np.array x (float np.array,np.array) list -&gt; int</code> qui, étant donné une image et l'ensemble de paramètres déterminés dans la question 3, renvoie la classe la plus probable de l'image, c'est-à-dire celle dont la log-vraisemblance est la plus grande.
</p>
<p class="vspace">Vous pourrez vérifier que vous obtenez les mêmes résultats que ci-dessous:
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock8">
  <div class="sourceblocktext"><div class="python">classify_image<span class="br0">(</span> test_data<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">5</span><span class="br0">]</span><span class="sy0">,</span> parameters <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=8" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><pre> 1
</pre><div class="vspace"></div>
<div class="sourceblock " id="sourceblock9">
  <div class="sourceblocktext"><div class="python">classify_image<span class="br0">(</span> test_data<span class="br0">[</span><span class="nu0">4</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">,</span> parameters <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=9" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><pre> 9
</pre><p class="vspace"><br>
</p>
<div class="vspace"></div><hr>
<h2 style="background-color: #e6d8c0;">Partie optionnelle</h2>
<hr>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">7. Classification de toutes les images</span></strong></span>
</p>
<p class="vspace">Ecrivez maintenant une fonction <strong>classify_all_images</strong> <code>: float np.array np.array np.array x (np.array,np.array) list -&gt; float np.2D-array</code> qui, étant donné le tableau <code>test_data</code> des images du fichiers 2015_tme3_usps_test.txt tel que retourné par la fonction <strong>read_file</strong> et l'ensemble de paramètres déterminés dans la question 3, renvoie un tableau numpy bi-dimensionnel <strong>T</strong> de taille 10x10 tel que <strong>T</strong>[i,j] représente le pourcentage d'images correspondant dans la réalité au chiffre i que votre classifieur a classées dans la classe j (pour tout i, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-343" style="width: 2.808em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.309em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.063em 1000em 2.808em -0.496em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-344"><span class="munderover" id="MathJax-Span-345"><span style="display: inline-block; position: relative; width: 2.309em; height: 0px;"><span style="position: absolute; clip: rect(1.374em 1000em 2.746em -0.496em); top: -2.303em; left: 0.003em;"><span class="mo" id="MathJax-Span-346" style="font-family: MathJax_Size1; vertical-align: 0.003em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 2.309em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.372em -0.558em); top: -2.677em; left: 1.063em;"><span class="texatom" id="MathJax-Span-347"><span class="mrow" id="MathJax-Span-348"><span class="mn" id="MathJax-Span-349" style="font-size: 70.7%; font-family: MathJax_Main;">9</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span><span style="position: absolute; clip: rect(1.499em 1000em 2.496em -0.558em); top: -1.867em; left: 1.063em;"><span class="texatom" id="MathJax-Span-350"><span class="mrow" id="MathJax-Span-351"><span class="mi" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mo" id="MathJax-Span-353" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-354" style="font-size: 70.7%; font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.829em; vertical-align: -0.605em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\sum_{j=0}^{9}</script> <strong>T</strong>[i,<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-355" style="width: 0.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.377em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.312em 1000em 2.559em -0.558em); top: -2.179em; left: 0.003em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math; font-style: italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.185em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.221em; vertical-align: -0.3em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">j</script>] = 100%).
</p>
<p class="vspace">Vous pourrez vérifier que:
</p>
<div class="vspace"></div><ul><li><strong>T</strong>[0,0] = 0.84958217
</li><li><strong>T</strong>[2,3] = 0.040404040404040407
</li><li><strong>T</strong>[5,3] = 0.050000000000000003
</li></ul><p class="vspace"><br>
</p>
<p class="vspace"><span style="font-size:120%"><strong><span style="color: blue;">8. Affichage du résultat des classifications</span></strong></span>
</p>
<p class="vspace">Afin de visualiser les résultats obtenus par votre classifieur, exécutez la fonction suivante, qui prend en paramètres le tableau obtenu à la question précédente. Si votre classifieur est performant, vous devriez observer des pics sur la diagonale.
</p>
<div class="vspace"></div>
<div class="sourceblock " id="sourceblock10">
  <div class="sourceblocktext"><div class="python"><span class="kw1">from</span> mpl_toolkits.<span class="me1">mplot3d</span> <span class="kw1">import</span> Axes3D<br>
<br>
<span class="kw1">def</span> dessine <span class="br0">(</span> classified_matrix <span class="br0">)</span>:<br>
&nbsp; &nbsp; fig <span class="sy0">=</span> plt.<span class="me1">figure</span><span class="br0">(</span><span class="br0">)</span><br>
&nbsp; &nbsp; ax <span class="sy0">=</span> fig.<span class="me1">add_subplot</span><span class="br0">(</span><span class="nu0">111</span><span class="sy0">,</span> projection<span class="sy0">=</span><span class="st0">'3d'</span><span class="br0">)</span><br>
&nbsp; &nbsp; x <span class="sy0">=</span> y <span class="sy0">=</span> np.<span class="me1">linspace</span> <span class="br0">(</span> <span class="nu0">0</span><span class="sy0">,</span> <span class="nu0">9</span><span class="sy0">,</span> <span class="nu0">10</span> <span class="br0">)</span><br>
&nbsp; &nbsp; X<span class="sy0">,</span> Y <span class="sy0">=</span> np.<span class="me1">meshgrid</span><span class="br0">(</span>x<span class="sy0">,</span> y<span class="br0">)</span><br>
&nbsp; &nbsp; ax.<span class="me1">plot_surface</span><span class="br0">(</span>X<span class="sy0">,</span> Y<span class="sy0">,</span> classified_matrix<span class="sy0">,</span> rstride <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">,</span> cstride<span class="sy0">=</span><span class="nu0">1</span> <span class="br0">)</span></div></div>
  <div class="sourceblocklink"><a href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=sourceblock&amp;num=10" type="text/plain">[$[Get Code]]</a></div>
</div>

<div class="vspace"></div><div style="text-align: center;">   <img width="450px" src="./MAPSI Cours_TME 3_files/2015_tme3_classified.jpg" alt="" title=""> </div>
<div class="vspace"></div>
</div>

				</div>
			</div>

			<div id="sidebar">
				<!--PageSearchFmt-->
				<div class="boxy short">
					<div id="search">
						<h3>Search</h3>

						<form id="searchform" action="http://mapsi.lip6.fr/pmwiki.php" method="get">
						<fieldset>
							<input type="hidden" name="n" value="Cours.TME3">
							<input type="hidden" name="action" value="search">
							<input class="searchBox" type="text" id="q" name="q" value="">
							<input class="searchButton" type="submit" value="Go">
						</fieldset>
						</form>
					</div>
				</div>
				<!--/PageSearchFmt-->

				<!--PageRightFmt-->
				<div class="boxy tall">
					<p class="sidehead"> <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Main.TutoPython">Tutoriel numpy</a>
</p>
<p class="vspace sidehead"> <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Main.Salles">Infos Cours/TD/TME</a>
</p>
<p class="vspace sidehead"> <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Main.Annales">Annales</a>
</p>
<p class="vspace sidehead"> Semainier
</p><ul><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine1">Semaine 1</a>  
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine2">Semaine 2</a>  
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine3">Semaine 3</a>  
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine4">Semaine 4</a>  
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine5">Semaine 5</a>
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine6">Semaine 6</a>  
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine7">Semaine 7</a>  
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine8">Semaine 8</a>  
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine9">Semaine 9</a>  
</li><li><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.Semaine10">Semaine 10</a>  
</li></ul><p class="vspace sidehead"> <a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Main.Examen">Infos Examen</a>
</p>
<p class="vspace sidehead"> Liens
</p>
<p class="vspace" style="text-align: right;"> <span style="font-size:83%"><a class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Site.SideBar?action=edit">edit SideBar</a></span>
</p>

				</div>
				<!--/PageRightFmt-->
			</div>
		</div>

		<div id="options-container">
			<!--PageOptionsFmt-->
			<div id="options">
				<h2>Options:</h2>
				<ul id="option_size">
					<li title="size: fixed" id="option_size_fixed" class="fixed"><a><span>fixed</span></a></li>
					<li title="size: fluid" id="option_size_fluid" class="fluid"><a><span>fluid</span></a></li>
				</ul>

				<ul id="option_color">
					<li title="color: orange" id="option_color_orange" class="orange"><a><span>orange</span></a></li>
					<li title="color: blue" id="option_color_blue" class="blue"><a><span>blue</span></a></li>
					<li title="color: green" id="option_color_green" class="green"><a><span>green</span></a></li>
					<li title="color: pink" id="option_color_pink" class="pink"><a><span>pink</span></a></li>
					<li title="color: cyan" id="option_color_cyan" class="cyan"><a><span>cyan</span></a></li>
					<li title="color: red" id="option_color_red" class="red"><a><span>red</span></a></li>
					<li title="color: violet" id="option_color_violet" class="violet"><a><span>violet</span></a></li>
				</ul>
			</div>
			<!--/PageOptionsFmt-->

			<!--PageActionFmt-->
			<div class="pageactions">
				<ul><li class="browse">      <a accesskey="" rel="nofollow" class="selflink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3">View</a>
</li><li class="edit">      <a accesskey="e" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=edit">Edit</a>
</li><li class="diff">   <a accesskey="h" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=diff">History</a>
</li><li class="print">     <a accesskey="" rel="nofollow" class="wikilink" href="http://mapsi.lip6.fr/pmwiki.php?n=Cours.TME3?action=print">Print</a>
</li></ul>

			</div>
			<!--/PageActionFmt-->
		</div>

		<div id="footer">
			<!--PageFooterFmt-->
				<div class="footer"><p>Page last modified on October 04, 2017, at 08:25 AM EST
</p>
</div>
			<!--/PageFooterFmt-->
			<p id="credits"><a href="http://evil.che.lu/projects/skittlish">Skittlish</a> theme adapted by <a href="http://solidgone.org/Skins/">David Gilbert</a>, powered by <a href="http://pmwiki.com/">PmWiki</a></p>
		</div>
	</div>
<!--HTMLFooter-->


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size4, sans-serif;"></div></div></body></html>